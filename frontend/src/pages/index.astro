---
import Layout from '../layouts/Layout.astro';
import Gallery from '../components/Gallery.astro';
import Container from '../components/Container.astro';
import { fetchHomePage } from '../lib/strapi';

let homePage = null;
let error = null;

try {
  homePage = await fetchHomePage();
} catch (e) {
  error = e.message;
}

const pageTitle = homePage ? homePage.heading : 'Personal Website';
---

<Layout title={pageTitle}>
	{error ? (
		<Container class="text-center py-16 min-h-screen flex flex-col justify-center items-center">
			<h1 class="text-4xl mb-4 text-gray-800">Error loading content</h1>
			<p class="text-gray-600 text-lg">{error}</p>
		</Container>
	) : homePage ? (
		<>
			<!-- Hero Section -->
			<Container class="section-padding">
				<div class="text-center">
					<h1 class="text-display text-6xl md:text-7xl lg:text-8xl text-charcoal mb-6">
						{homePage.heading}
					</h1>
					<p class="text-body text-xl text-charcoal leading-relaxed">
						{homePage.aboutBlurb}
					</p>
				</div>
			</Container>

			{homePage.gallery && homePage.gallery.length > 0 && (
				<Gallery images={homePage.gallery} />
			)}

			<Container class="section-padding">
				<footer class="text-center">
					<div class="vibrant-card inline-block">
						<p class="text-body text-charcoal">
							Built with <strong class="text-headline">Astro</strong> âš¡ and <strong class="text-headline">Strapi</strong> ðŸš€
						</p>
					</div>
				</footer>
			</Container>
		</>
	) : (
		<Container class="text-center py-16 min-h-screen flex flex-col justify-center items-center">
			<h1 class="text-4xl mb-4 text-gray-800">Loading...</h1>
		</Container>
	)}
</Layout>
