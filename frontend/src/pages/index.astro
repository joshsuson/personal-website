---
import Layout from '../layouts/Layout.astro';
import Gallery from '../components/Gallery.astro';
import Container from '../components/Container.astro';
import { fetchHomePage } from '../lib/strapi';

let homePage = null;
let error = null;

try {
  homePage = await fetchHomePage();
} catch (e) {
  error = e.message;
}

const pageTitle = homePage ? homePage.heading : 'Personal Website';
---

<Layout title={pageTitle}>
	{error ? (
		<Container class="text-center py-16 min-h-screen flex flex-col justify-center items-center">
			<h1 class="text-4xl mb-4 text-gray-800">Error loading content</h1>
			<p class="text-gray-600 text-lg">{error}</p>
		</Container>
	) : homePage ? (
		<>
			<Container class="mt-9">
				<header class="text-center py-16 mb-12">
					<h1 class="text-6xl md:text-7xl mb-6 bg-gradient-to-r from-indigo-500 to-purple-600 bg-clip-text text-transparent font-bold">{homePage.heading}</h1>
					<p class="text-xl text-gray-600 leading-relaxed">{homePage.aboutBlurb}</p>
				</header>
			</Container>

			{homePage.gallery && homePage.gallery.length > 0 && (
				<Gallery images={homePage.gallery} />
			)}

			<Container class="mt-24">
				<footer class="text-center py-8 text-gray-600 text-lg">
					<p>Built with <strong class="text-gray-800">Astro</strong> âš¡ and <strong class="text-gray-800">Strapi</strong> ðŸš€</p>
				</footer>
			</Container>
		</>
	) : (
		<Container class="text-center py-16 min-h-screen flex flex-col justify-center items-center">
			<h1 class="text-4xl mb-4 text-gray-800">Loading...</h1>
		</Container>
	)}
</Layout>
